annotation:shrink('/bootstrap':signature(insertDocument(Instance,DB,ID,Content)::'/javascript/statepred':statePred,[Instance::'/javascript/statepred':stateExpr('/bootstrap':string),DB::'/javascript/statepred':stateExpr('/bootstrap':string),ID::'/javascript/statepred':stateExpr('/bootstrap':string),Content::'/javascript/jsLogic':jsExpr])).
annotation:shrink('/bootstrap':projection(insertDocument(Instance,DB,ID,Content)::'/javascript/statepred':statePred,'/bootstrap':horiz(['/bootstrap':label(!'insert document'),'/bootstrap':vis(ID::'/javascript/statepred':stateExpr('/bootstrap':string)),'/bootstrap':label(!'with content'),'/bootstrap':vis(Content::'/javascript/jsLogic':jsExpr),'/bootstrap':label(!'to database'),'/bootstrap':vis(DB::'/javascript/statepred':stateExpr('/bootstrap':string)),'/bootstrap':label(!on),'/bootstrap':vis(Instance::'/javascript/statepred':stateExpr('/bootstrap':string))]))).
annotation:shrink('/javascript/statepred':clause(insertDocument(Instance,DB,ID,Content),'/javascript/statepred':if('/javascript/statepred':pred(builtin:var(ID::'/javascript/statepred':stateExpr('/bootstrap':string))),'/javascript/statepred':conj('/cedalionWeb/node':http(!'POST','/javascript/statepred':stateApplyBinOp(Instance,'/Functional':concat,'/javascript/statepred':stateApplyBinOp('/javascript/statepred':expr('/Functional':const(! (/))),'/Functional':concat,DB)),'/javascript/jsLogic':jsExpr('/javascript':json(['/javascript':bind('/javascript':str(!'content-type'),'/javascript':str(!'application/json'))])),'/cedalionWeb/node':jsonStringify(Content),201,_,Response),'/javascript/statepred':conj('/javascript/statepred':stateEval('/cedalionWeb/node':string('/cedalionWeb/node':dot('/cedalionWeb/node':json('/javascript/statepred':expr('/Functional':const(Response))),!ok)),'/bootstrap':string,!true),'/javascript/statepred':conj('/javascript/statepred':stateEval('/cedalionWeb/node':string('/cedalionWeb/node':dot('/cedalionWeb/node':json('/javascript/statepred':expr('/Functional':const(Response))),!id)),'/bootstrap':string,IDPrime),'/javascript/statepred':pred(ID::'/javascript/statepred':stateExpr('/bootstrap':string)='/javascript/statepred':expr('/Functional':const(IDPrime))::'/javascript/statepred':stateExpr('/bootstrap':string))))),'/javascript/statepred':conj('/cedalionWeb/node':http(!'PUT','/javascript/statepred':stateApplyBinOp(Instance,'/Functional':concat,'/javascript/statepred':stateApplyBinOp('/javascript/statepred':expr('/Functional':const(! (/))),'/Functional':concat,'/javascript/statepred':stateApplyBinOp(DB,'/Functional':concat,'/javascript/statepred':stateApplyBinOp('/javascript/statepred':expr('/Functional':const(! (/))),'/Functional':concat,ID)))),'/javascript/jsLogic':jsExpr('/javascript':json(['/javascript':bind('/javascript':str(!'content-type'),'/javascript':str(!'application/json'))])),'/cedalionWeb/node':jsonStringify(Content),201,_,Response),'/javascript/statepred':stateEval('/cedalionWeb/node':string('/cedalionWeb/node':dot('/cedalionWeb/node':json('/javascript/statepred':expr('/Functional':const(Response))),!ok)),'/bootstrap':string,!true))))).
'/bootstrap':disabled('/javascript/statepred':unitTest('/javascript/statepred':conj(createDatabase('/javascript/statepred':expr('/Functional':const(!'http://localhost:5984')),'/javascript/statepred':expr('/Functional':const(!insert_db))),'/javascript/statepred':conj(insertDocument('/javascript/statepred':expr('/Functional':const(!'http://localhost:5984')),'/javascript/statepred':expr('/Functional':const(!insert_db)),Doc,'/javascript/jsLogic':jsExpr('/javascript':json(['/javascript':bind('/javascript':str(!a),'/javascript':const(1)),'/javascript':bind('/javascript':str(!b),'/javascript':const(2)),'/javascript':bind('/javascript':str(!c),'/javascript':const(3))]))),'/javascript/statepred':conj(updateDocument('/javascript/statepred':expr('/Functional':const(!'http://localhost:5984')),'/javascript/statepred':expr('/Functional':const(!insert_db)),Doc,'/javascript/jsLogic':jsExpr('/javascript':json(['/javascript':bind('/javascript':str(!a),'/javascript':const(4)),'/javascript':bind('/javascript':str(!b),'/javascript':const(5)),'/javascript':bind('/javascript':str(!c),'/javascript':const(6))]))),'/javascript/statepred':conj('/javascript/statepred':stateEval('/cedalionWeb/node':string('/cedalionWeb/node':dot('/cedalionWeb/node':json('/cedalionWeb/node':get('/javascript/statepred':stateApplyBinOp('/javascript/statepred':expr('/Functional':const(!'http://localhost:5984/insert_db/')),'/Functional':concat,Doc))),!b)),'/bootstrap':string,!'5'),deleteDatabase('/javascript/statepred':expr('/Functional':const(!'http://localhost:5984')),'/javascript/statepred':expr('/Functional':const(!insert_db))))))))).
annotation:shrink('/bootstrap':signature(updateDocument(Instance,DB,ID,NewContent)::'/javascript/statepred':statePred,[Instance::'/javascript/statepred':stateExpr('/bootstrap':string),DB::'/javascript/statepred':stateExpr('/bootstrap':string),ID::'/javascript/statepred':stateExpr('/bootstrap':string),NewContent::'/javascript/jsLogic':jsExpr])).
annotation:shrink('/bootstrap':projection(updateDocument(Instance,DB,ID,NewContent)::'/javascript/statepred':statePred,'/bootstrap':horiz(['/bootstrap':label(!'update document'),'/bootstrap':vis(ID::'/javascript/statepred':stateExpr('/bootstrap':string)),'/bootstrap':label(!'with content'),'/bootstrap':vis(NewContent::'/javascript/jsLogic':jsExpr),'/bootstrap':label(!'in database'),'/bootstrap':vis(DB::'/javascript/statepred':stateExpr('/bootstrap':string)),'/bootstrap':label(!on),'/bootstrap':vis(Instance::'/javascript/statepred':stateExpr('/bootstrap':string))]))).
annotation:shrink('/javascript/statepred':clause(updateDocument(Instance,DB,ID,NewContent),'/javascript/statepred':if('/javascript/statepred':conj('/javascript/statepred':stateEval('/cedalionWeb/node':string('/cedalionWeb/node':dot('/cedalionWeb/node':json('/cedalionWeb/node':get('/javascript/statepred':stateApplyBinOp(Instance,'/Functional':concat,'/javascript/statepred':stateApplyBinOp('/javascript/statepred':expr('/Functional':const(! (/))),'/Functional':concat,'/javascript/statepred':stateApplyBinOp(DB,'/Functional':concat,'/javascript/statepred':stateApplyBinOp('/javascript/statepred':expr('/Functional':const(! (/))),'/Functional':concat,ID)))))),!'_rev')),'/bootstrap':string,Rev),updateDocument(Instance,DB,ID,Rev,NewContent)),'/javascript/statepred':pred(builtin:true),insertDocument(Instance,DB,ID,NewContent)))).
'/bootstrap':signature(updateDocument(Instance,DB,ID,Rev,NewContent)::'/javascript/statepred':statePred,[Instance::'/javascript/statepred':stateExpr('/bootstrap':string),DB::'/javascript/statepred':stateExpr('/bootstrap':string),ID::'/javascript/statepred':stateExpr('/bootstrap':string),Rev::'/bootstrap':string,NewContent::'/javascript/jsLogic':jsExpr]).
'/bootstrap':projection(updateDocument(Instance,DB,ID,Rev,NewContent)::'/javascript/statepred':statePred,'/bootstrap':horiz(['/bootstrap':label(!'update document'),'/bootstrap':vis(ID::'/javascript/statepred':stateExpr('/bootstrap':string)),'/bootstrap':label(!revision),'/bootstrap':vis(Rev::'/bootstrap':string),'/bootstrap':label(!'with content'),'/bootstrap':vis(NewContent::'/javascript/jsLogic':jsExpr),'/bootstrap':label(!'in database'),'/bootstrap':vis(DB::'/javascript/statepred':stateExpr('/bootstrap':string)),'/bootstrap':label(!on),'/bootstrap':vis(Instance::'/javascript/statepred':stateExpr('/bootstrap':string))])).
annotation:shrink('/javascript/statepred':clause(updateDocument(Instance,DB,ID,Rev,NewContent),'/javascript/statepred':conj(addRevision(NewContent,Rev,Content),'/javascript/statepred':conj('/cedalionWeb/node':http(!'PUT','/javascript/statepred':stateApplyBinOp(Instance,'/Functional':concat,'/javascript/statepred':stateApplyBinOp('/javascript/statepred':expr('/Functional':const(! (/))),'/Functional':concat,'/javascript/statepred':stateApplyBinOp(DB,'/Functional':concat,'/javascript/statepred':stateApplyBinOp('/javascript/statepred':expr('/Functional':const(! (/))),'/Functional':concat,ID)))),'/javascript/jsLogic':jsExpr('/javascript':json(['/javascript':bind('/javascript':str(!'content-type'),'/javascript':str(!'application/json'))])),'/cedalionWeb/node':jsonStringify(Content),201,_,Response),'/javascript/statepred':stateEval('/cedalionWeb/node':string('/cedalionWeb/node':dot('/cedalionWeb/node':json('/javascript/statepred':expr('/Functional':const(Response))),!ok)),'/bootstrap':string,!true))))).
'/bootstrap':signature(addRevision(NewContent,Rev,ContentWithRev)::'/javascript/statepred':statePred,[NewContent::'/javascript/jsLogic':jsExpr,Rev::'/bootstrap':string,ContentWithRev::'/javascript/jsLogic':jsExpr]).
'/javascript/statepred':def(addRevision(NewContent,Rev,ContentWithRev),Action,Finally,'/javascript/jsLogic':jsCommand(['/javascript':var(S,'/javascript/jsLogic':inlineTerm(NewContent::'/javascript/jsLogic':jsExpr)),'/javascript':assign('/javascript':dot('/javascript':varExpr(S),!'_rev'),'/javascript/jsLogic':inlineTerm(Rev::'/bootstrap':string)),'/javascript/jsLogic':runProcedure('/javascript/jsLogic':foreach(ContentWithRev::'/javascript/jsLogic':jsExpr='/javascript/jsLogic':jsExpr('/javascript':varExpr(S))::'/javascript/jsLogic':jsExpr,Action)),'/javascript/jsLogic':runProcedure('/javascript/jsLogic':do(Finally))])).
